---
title: Java内存区域
date: 2019-01-15
comments: true 
tags:
- JVM
categories:  
- Java虚拟机
---
## Java 运行时数据区域
`Java`虚拟机所管理的内存包括如下图所示的几个运行时数据区域
![](../../img/2018120731.png)

### Java方法区
方法区是线程共享区域，用于存储已被虚拟机加载的类信息，常量，静态变量，以及编译器编译后的代码等数据。 运行时常量池属于方法取得一部分。  

### Java栈
`Java` 栈分为两块，包含虚拟机栈和本地方法栈。
   
#### 虚拟机栈
虚拟机栈是线程私有的，它的生命周期与线程相同，每个方法运行时都会创建一个栈帧，用于存储局部变量表，操作数栈，动态链接，方法出入口信息等，每个方法从调用直至执行完成的过程，就对应着一个栈帧从虚拟机中入栈到出栈的过程。   
其中局部变量表存放了8中基本类型数据，还有对象的引用。在`Java`虚拟机中对栈规定了两种异常情况，如果请求的栈的深度大于虚拟机所允许栈的深度，将抛出`StackOverflowError`异常，如果虚拟机可以动态扩展并且在扩展时无法申请足够的内存，那么将会抛出`OutOfMemoryError`异常。   

#### 本地方法栈
本地方法栈与虚拟机栈所发挥的作用类似，区别在于虚拟机栈为虚拟机执行`Java`方法服务， 本地方法栈为虚拟机执行`Native`方法服务。与虚拟机栈一样，本地方法栈也会抛出上面两种异常。

### Java堆
`Java`堆是线程共享爱的。对大多数应用来说， `Java`堆是 虚拟机中被管理的最大的一块线程共享区域，在该区域存放的是对象的实例，几乎所有的对象实例都在堆中分配。
`Java`堆是垃圾收集器管理的主要区域。现在的收集器基本都采用分代收集法，堆中可以细分为新生代和老年代，再细致一点可以分为 `Eden`区，`From Survivor`区域，`To Survivor`区域。

### 程序计数器
程序计数器是一块较小的内存空间，可以作为线程的指示器。字节码解释器工作是通过改变记数器的值来选取下一条需要执行的字节码指令，分支，循环，跳转，异常处理，线程恢复等基础功能都依赖计数器来完成。